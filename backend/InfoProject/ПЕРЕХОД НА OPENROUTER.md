# üöÄ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ OpenRouter —Å MiniMax

**–î–∞—Ç–∞:** 08.11.2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚ùå –ë—ã–ª–æ: Google Gemini 2.5 Flash
- ‚ö†Ô∏è –¢—Ä–µ–±–æ–≤–∞–ª VPN/–ø—Ä–æ–∫—Å–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã
- ‚ö†Ô∏è –ü—Ä–æ–∫—Å–∏: `http://127.0.0.1:12334`
- ‚ö†Ô∏è –ß–∞—Å—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ –†–æ—Å—Å–∏–∏

### ‚úÖ –°—Ç–∞–ª–æ: MiniMax —á–µ—Ä–µ–∑ OpenRouter
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó VPN!**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å: `minimax/minimax-01:free`
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API

---

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
**–§–∞–π–ª:** `backend/Services/OpenRouterService.cs`
- –†–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IGeminiService`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç OpenRouter API
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é (–±–µ–∑ –ø—Ä–æ–∫—Å–∏)

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª:** `backend/appsettings.json`
```json
"OpenRouter": {
  "ApiKey": "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"
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
**–§–∞–π–ª:** `backend/Program.cs`
```csharp
// –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenRouter —Å MiniMax (—Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó VPN!)
builder.Services.AddHttpClient<IGeminiService, OpenRouterService>();
builder.Services.AddScoped<IGeminiService, OpenRouterService>();
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### API Endpoint
```
https://openrouter.ai/api/v1/chat/completions
```

### –ú–æ–¥–µ–ª—å
```
minimax/minimax-01:free
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- **Temperature:** 0.3 (–¥–ª—è —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- **Max tokens:** 1024 (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
- **Timeout:** 60 —Å–µ–∫—É–Ω–¥

### –ó–∞–≥–æ–ª–æ–≤–∫–∏
```
Authorization: Bearer {API_KEY}
HTTP-Referer: https://mvd-project.local
X-Title: MVD Request Analysis System
Content-Type: application/json
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–µ–∫–µ–Ω–¥
cd backend
dotnet run
```

### –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ Swagger

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5029
2. –ù–∞–π–¥–∏—Ç–µ `POST /api/CitizenRequests/analyze`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ:
```json
{
  "description": "–£ –º–µ–Ω—è —É–∫—Ä–∞–ª–∏ –≤–µ–ª–æ—Å–∏–ø–µ–¥"
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "category": "–ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏—è",
  "summary": "–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ –∫—Ä–∞–∂–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞",
  "sentiment": "–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π",
  "priority": "–°—Ä–µ–¥–Ω–∏–π",
  "suggestedAction": "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ, –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ—Å–º–æ—Ç—Ä –º–µ—Å—Ç–∞ –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è"
}
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Gemini (—Å—Ç–∞—Ä–æ–µ) | MiniMax (–Ω–æ–≤–æ–µ) |
|----------|-----------------|-----------------|
| –¢—Ä–µ–±—É–µ—Ç VPN | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ | ~2-3 —Å–µ–∫ | ~1-2 —Å–µ–∫ |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è | ‚úÖ –í—ã—Å–æ–∫–∞—è |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ |
| –ö–∞—á–µ—Å—Ç–≤–æ | –û—Ç–ª–∏—á–Ω–æ–µ | –•–æ—Ä–æ—à–µ–µ |

---

## üîÑ –ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Gemini (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Gemini:

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ `backend/Program.cs`
```csharp
// –í–º–µ—Å—Ç–æ OpenRouterService –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GeminiService
builder.Services.AddHttpClient<IGeminiService, GeminiService>();
builder.Services.AddScoped<IGeminiService, GeminiService>();
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–µ–∫–µ–Ω–¥
```bash
cd backend
dotnet run
```

---

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ OpenRouter

### 1. –ë–µ–∑ VPN
–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –†–æ—Å—Å–∏–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

### 2. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π
–ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –º–æ–¥–µ–ª—å:
```csharp
private const string MODEL = "minimax/minimax-01:free";
// –ò–ª–∏
private const string MODEL = "google/gemini-2.0-flash-exp:free";
// –ò–ª–∏
private const string MODEL = "meta-llama/llama-3.2-3b-instruct:free";
```

### 3. –ï–¥–∏–Ω—ã–π API
OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ https://openrouter.ai/activity

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

### –ì–¥–µ –≤–∑—è—Ç—å –∫–ª—é—á?
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://openrouter.ai/
2. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á: https://openrouter.ai/keys
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –≤ `appsettings.json`

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã
- **MiniMax-01**: 200 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ - –º–æ–∂–Ω–æ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "API key not found"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `appsettings.json`, —Å–µ–∫—Ü–∏—è `OpenRouter:ApiKey`

### –ü—Ä–æ–±–ª–µ–º–∞: "401 Unauthorized"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "429 Too Many Requests"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∏–ª–∏ –ø–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ `OpenRouterService.cs`:
```csharp
_httpClient.Timeout = TimeSpan.FromSeconds(90);
```

---

## üìù –õ–æ–≥–∏

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ `appsettings.json`:

```json
"Logging": {
  "LogLevel": {
    "Default": "Information",
    "MvdBackend.Services.OpenRouterService": "Debug"
  }
}
```

---

## üéâ –ò—Ç–æ–≥–æ

‚úÖ –ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ VPN**  
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è** –º–æ–¥–µ–ª—å MiniMax  
‚úÖ API –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é  
‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ  
‚úÖ –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏  

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**OpenRouter –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://openrouter.ai/docs  
**MiniMax –º–æ–¥–µ–ª–∏:** https://openrouter.ai/models/minimax  
**API —Å—Ç–∞—Ç—É—Å:** https://openrouter.ai/status  

---

**–°–æ–∑–¥–∞–Ω–æ:** 08.11.2024  
**–í–µ—Ä—Å–∏—è:** 3.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant  

